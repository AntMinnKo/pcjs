(function(){var m;function aa(a){var b=16,c;if(a){b||(b=16);if("$"==a.charAt(0))b=16,a=a.substr(1);else if("0x"==a.substr(0,2))b=16,a=a.substr(2);else{var d=a.charAt(a.length-1).toLowerCase();"h"==d?(b=16,d=null):"."==d&&(b=10,d=null);null==d&&(a=a.substr(0,a.length-1))}var e,d=a,f=b;(f&&10!=f?16==f?null!==d.match(/^[0-9a-f]+$/i):2==f&&null!==d.match(/^[01]+$/i):null!==d.match(/^[0-9]+$/))&&!isNaN(e=parseInt(a,b))&&(c=e|0)}return c}
function n(a,b){var c="";void 0===b?b=8:8<b&&(b=8);if(null==a||isNaN(a))for(;0<b--;)c="?"+c;else for(;0<b--;){var d=a&15,d=d+(0<=d&&9>=d?48:55),c=String.fromCharCode(d)+c;a>>=4}return c}function ba(a,b){var c=a,d=a.lastIndexOf("/");0<=d&&(c=a.substr(d+1));d=c.indexOf("&");0<d&&(c=c.substr(0,d));b&&(d=c.lastIndexOf("."),0<d&&(c=c.substring(0,d)));return c}function ca(a){var b="",c=a.lastIndexOf(".");0<=c&&(b=a.substr(c+1).toLowerCase());return b}
function da(a,b){return-1!==a.indexOf(b,a.length-b.length)}var ea={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};function fa(a){return a.replace(/[&<>"']/g,function(a){return ea[a]})}var ga=Date.now||function(){return+new Date};function ia(){function a(a){return(10>a?"0":"")+a}var b=new Date;return b.getFullYear()+"-"+a(b.getMonth()+1)+"-"+a(b.getDate())+" "+a(b.getHours())+":"+a(b.getMinutes())+":"+a(b.getSeconds())}
function p(a,b,c,d){var e=0,f=null,h=null;if("object"==typeof resources&&(f=resources[a]))return d&&d(a,f,e),[f,e];if(c&&"function"==typeof resources)return resources(a,function(b,c){d&&d(a,b,c)}),h;var g=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");c&&(g.onreadystatechange=function(){4===g.readyState&&(f=g.responseText,200==g.status||!g.status&&f.length&&"file:"==(window?window.location.protocol:"file:")||(e=g.status||-1),d&&d(a,f,e))});if(b&&"object"==
typeof b){var k="",l;for(l in b)b.hasOwnProperty(l)&&(k&&(k+="&"),k+=l+"="+encodeURIComponent(b[l]));k=k.replace(/%20/g,"+");g.open("POST",a,!!c);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");g.send(k)}else g.open("GET",a,!!c),"bytes"==b&&g.overrideMimeType("text/plain; charset=x-user-defined"),g.send();c||(f=g.responseText,200!=g.status&&(e=g.status||-1),d&&d(a,f,e),h=[f,e]);return h}function ja(){return"http://"+(window?window.location.host:"www.pcjs.org")}
function q(a){window&&window.alert(a)}function ka(a){var b=!1;window&&(b=window.confirm(a));return b}var ma=null;function na(){if(null==ma){var a=!1;if(window)try{window.localStorage.setItem("PCjs.localStorage","PCjs.localStorage"),a="PCjs.localStorage"==window.localStorage.getItem("PCjs.localStorage"),window.localStorage.removeItem("PCjs.localStorage")}catch(b){a=!1}ma=a}return ma}function oa(a){var b;if(window)try{b=window.localStorage.getItem(a)}catch(c){}return b}
function pa(a,b){try{return window.localStorage.setItem(a,b),!0}catch(c){}return!1}function qa(a){if(window){var b=window?window.navigator.userAgent:"";return"iOS"==a&&b.match(/(iPod|iPhone|iPad)/)&&b.match(/AppleWebKit/)||"MSIE"==a&&b.match(/(MSIE|Trident)/)||0<=b.indexOf(a)?!0:!1}return!1}var ta={init:[],show:[],exit:[]},ua=!1,va=!0;function wa(a,b){if(window){var c=window[a];window[a]="function"!==typeof c?b:function(){c&&c();b()}}}function xa(a){ta.init.push(a)}
function ya(a){if(va)try{for(var b=0;b<a.length;b++)a[b]()}catch(c){q("An unexpected exception occurred:\n\n"+c.message+"\n\nPlease send this information to support@pcjs.org. Thanks.")}}function za(a){!va&&a?(va=!0,ua&&Aa("init")):va=a}function Aa(a){ta[a]&&ya(ta[a])}wa("onload",function(){ua=!0;ya(ta.init)});wa("onpageshow",function(){ya(ta.show)});wa(qa("Opera")||qa("iOS")?"onunload":"onbeforeunload",function(){ya(ta.exit)});
function t(a,b,c){this.type=a;b||(b={id:"",name:""});this.id=b.id;this.name=b.name;this.Sa=b.comment;this.eb=b;void 0===this.id&&(this.id="");b=this.id.indexOf(".");0<b?(this.Ua=this.id.substr(0,b),this.Ta=this.id.substr(b+1)):this.Ta=this.id;this[a]=c;this.g={ia:!1,qa:!1,Ia:!1,K:!1,ba:!1};this.Ba=null;this.g.ba=!1;this.A={};this.I=null;u.push(this)}var Ba=void 0,Ca={};
if(window){Ba||(Ba=window.location.search.substr(1));for(var Da,Ea=/\+/g,Ha=/([^&=]+)=?([^&]*)/g;Da=Ha.exec(Ba);)Ca[decodeURIComponent(Da[1].replace(Ea," "))]=decodeURIComponent(Da[2].replace(Ea," "))}function Ia(a){function b(){}if(window){if(!a)throw new TypeError;if(Object.create)return Object.create(a);var c=typeof a;if("object"!==c&&"function"!==c)throw new TypeError;}b.prototype=a;return new b}
function v(a,b){b||(b=t);a.prototype=Ia(b.prototype);a.prototype.constructor=a;a.prototype.parent=b.prototype}var u=[],Ja={};function Ka(a,b,c){Ja[a]&&b&&(Ja[a][b]=c)}function w(a){var b,c=[];a&&(a=0<(b=a.indexOf("."))?a.substr(0,b+1):"");for(b=0;b<u.length;b++){var d=u[b];a&&d.id.indexOf(a)||c.push(d)}return c}
function La(a,b){var c;if(void 0!==a){var d;b&&(b=0<(d=b.indexOf("."))?b.substr(0,d+1):"");for(d=0;d<u.length;d++)if(c)c==u[d]&&(c=null);else if(!(a!=u[d].type||b&&u[d].id.indexOf(b)))return u[d]}return null}function y(a){var b=null;if(a=a.getAttribute("data-value"))try{b=eval("("+a+")")}catch(c){q(c.message+" ("+a+")")}return b}
function Ma(a,b){for(var c=z(b.parentNode,"pc8080-control"),d=0;d<c.length;d++)for(var e=c[d].childNodes,f=0;f<e.length;f++){var h=e[f];if(1===h.nodeType){var g=h.getAttribute("class");if(g)for(var k=g.split(" "),l=0;l<k.length;l++)switch(g=k[l],g){case "pc8080-binding":(g=y(h))&&g.binding&&a.P(g.type,g.binding,h,g.value),l=k.length}}}}
function z(a,b,c){c&&(b+="-"+c+"-object");if(a.getElementsByClassName)return a.getElementsByClassName(b);var d;c=[];a=a.getElementsByTagName("*");var e=new RegExp("(^| )"+b+"( |$)");b=0;for(d=a.length;b<d;b++)e.test(a[b].className)&&c.push(a[b]);return c}
t.prototype={constructor:t,parent:null,toString:function(){return this.name?this.name:this.id||this.type},P:function(a,b,c){switch(b){case "clear":return this.A[b]||(this.A[b]=c,c.onclick=function(a){return function(){a.A.print&&(a.A.print.value="")}}(this)),!0;case "print":return this.A[b]||(this.Z=this.A[b]=c,c.value="",this.O=function(a){return function(b,c){8192<a.value.length&&(a.value=a.value.substr(a.value.length-4096));a.value+=(void 0!==c?c+": ":"")+(b||"")+"\n";a.scrollTop=a.scrollHeight}}(c),
this.L=function(a,b,c){this.O(a,"notice",c)}),!0;default:return!1}},log:function(){},O:function(){},status:function(a){this.O(this.Ta+": "+a)},L:function(a,b){b||q(a)},X:function(){return this.g.K=!0},W:function(a,b){b&&(this.g.K=!1);return!0}};function Na(a,b){if(a.g.Ia)return a.g.qa&&(a.g.qa=!1),a.g.Ia=!1;if(a.g.ba)return a.O(a.toString()+" error"),!1;a.g.qa=b;return a.g.qa}function B(a){if(!a.g.ba&&(a.g.ia=!0,a.g.ia)){var b=a.Ba;a.Ba=null;b&&b()}}
function Oa(a,b){b&&(a.g.ia?b():a.Ba=b);return a.g.ia}
var Pa="undefined"!==typeof ArrayBuffer,Qa=[1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,
0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1];function Ra(a){t.call(this,"Panel",a,Ra)}v(Ra);m=Ra.prototype;m.P=function(a,b,c,d){return this.v&&this.v.P(a,b,c,d)||this.a&&this.a.P(a,b,c,d)||this.b&&this.b.P(a,b,c,d)?!0:this.parent.P.call(this,a,b,c,d)};m.ca=function(a,b,c,d){this.v=a;this.w=b;this.a=c;this.I=d;this.b=Sa(a,"Keyboard")};m.X=function(a,b){b||Ta();return!0};m.W=function(){return!0};m.fa=function(){};
function Ta(){for(var a=!1,b=z(document,"pc8080","panel"),c=0;c<b.length;c++){var d=b[c],e=y(d),f;a:{f=e.id;if(void 0!==f)for(var h=void 0,h=0;h<u.length;h++)if(u[h].id===f){f=u[h];break a}f=null}f||(a=!0,f=new Ra(e));Ma(f,d);a&&B(f)}}xa(Ta);
function Ua(a,b,c){t.call(this,"Bus",a,Ua);this.a=b;this.I=c;this.i=a.busWidth||16;this.m=Math.pow(2,this.i);this.h=this.m-1|0;this.C=16>=this.i?10:20>=this.i?12:24>=this.i?14:15;this.H=1<<this.C;this.w=this.H>>2;this.c=this.H-1;this.f=this.m/this.H|0;this.v=this.f-1;this.j=[];this.l=[];this.o=[];this.B=[];a=new C;Va(a,this.I);this.b=Array(this.f);for(b=0;b<this.f;b++)this.b[b]=a;a=this.a;b=this.b;c=this.C;var d=this.h;a.M=b;a.C=c;a.H=1<<a.C;a.T=a.H-1;a.Oa=b.length;a.Ha=a.Oa-1;a.$=d;B(this)}v(Ua);
Ua.prototype.reset=function(){};Ua.prototype.X=function(a,b){b||this.reset();return!0};function Wa(a,b,c,d){for(var e=b>>>a.C;0<c&&e<a.b.length;){var f=a.b[e],h=e*a.H,g=a.H-(b-h);g>c&&(g=c);if(f&&f.size){if(f.type==d){if(b+c<=f.pa)return f.Ga+=f.pa-b,f.pa=b,!0;if(b>=f.pa+f.Ga){g=f.size-(b-h);g>c&&(g=c);f.Ga=b-f.pa+g;b=h+a.H;c-=g;e++;continue}}return Xa(1,b,c)}b=new C(b,g,a.H,d);Va(b,a.I,f);a.b[e++]=b;b=h+a.H;c-=g}return 0>=c?!0:Xa(2,b,c)}
Ua.prototype.F=function(a){return this.b[(a&this.h)>>>this.C].oa(a&this.c,a)};function Ya(a,b,c){a.b[(b&a.h)>>>a.C].hb(b&a.c,c&255,b)}function Xa(a,b,c){q("Memory block error ("+a+": "+n(b)+","+n(c)+")");return!1}var Za;if(Pa){var $a=new ArrayBuffer(2);(new DataView($a)).setUint16(0,256,!0);Za=256===(new Uint16Array($a))[0]}else Za=!1;var ab=Za;
function C(a,b,c,d){this.id=bb+=2;this.a=null;this.pa=a;this.Ga=b;this.size=c||0;this.type=d||cb;this.h=d==db;Va(this);this.R=this.Xa=!1;if(c)if(Pa)this.c=new ArrayBuffer(c),this.f=new DataView(this.c,0,c),this.b=new Uint8Array(this.c,0,c),this.l=new Uint16Array(this.c,0,c>>1),this.a=new Int32Array(this.c,0,c>>2),eb(this,ab?fb:gb);else{this.a=Array(c>>2);for(a=0;a<this.a.length;a++)this.a[a]=0;eb(this,hb)}else eb(this)}var cb=0,db=2,bb=0;
C.prototype={constructor:C,parent:null,save:function(){var a,b;if(Pa)for(a=Array(this.size>>2),b=0;b<a.length;b++)a[b]=this.f.getInt32(b<<2,!0);else a=this.a;return a},restore:function(a){if(a&&this.size==a.length<<2){var b;if(Pa)for(b=0;b<a.length;b++)this.f.setInt32(b<<2,a[b],!0);else this.a=a;return this.R=!0}return!1},m:function(){return 255},w:function(){},A:function(a,b){return this.oa(a++,b++)|this.oa(a,b)<<8},v:function(a,b,c){this.ya(a++,b&255,c++);this.ya(a,b>>8,c)},D:function(a){return this.a[a>>
2]>>>((a&3)<<3)&255},M:function(a){var b=a>>2;a=(a&3)<<3;var c=this.a[b]>>a;return 24>a?c&65535:c&255|(this.a[b+1]&255)<<8},V:function(a,b){var c=a>>2,d=(a&3)<<3;this.a[c]=this.a[c]&~(255<<d)|b<<d;this.R=!0},ha:function(a,b){var c=a>>2,d=(a&3)<<3;24>d?this.a[c]=this.a[c]&~(65535<<d)|b<<d:(this.a[c]=this.a[c]&16777215|b<<24,c++,this.a[c]=this.a[c]&-256|b>>8);this.R=!0},B:function(a,b){return this.Ma(a,b)},H:function(a,b){return this.fb(a,b)},T:function(a,b,c){this.h||this.hb(a,b,c)},$:function(a,b,
c){this.h||this.aa(a,b,c)},o:function(a){return this.b[a]},C:function(a){return this.b[a]},G:function(a){return this.f.getUint16(a,!0)},J:function(a){return a&1?this.b[a]|this.b[a+1]<<8:this.l[a>>1]},N:function(a,b){this.b[a]=b;this.R=!0},U:function(a,b){this.b[a]=b;this.R=!0},Y:function(a,b){this.f.setUint16(a,b,!0);this.R=!0},ga:function(a,b){a&1?(this.b[a]=b,this.b[a+1]=b>>8):this.l[a>>1]=b;this.R=!0}};function Va(a,b,c){a.I=b;a.i=a.j=0;c&&((a.i=c.i)&&ib(a,jb,!1),(a.j=c.j)&&kb(a,jb,!1))}
function kb(a,b,c){c&&a.j||(a.ya=!a.h&&b[2]||a.w,a.wb=!a.h&&b[3]||a.v);if(c||void 0===c)a.hb=b[2]||a.w,a.aa=b[3]||a.v}function ib(a,b,c){c&&a.i||(a.oa=b[0]||a.m,a.vb=b[1]||a.A);if(c||void 0===c)a.Ma=b[0]||a.m,a.fb=b[1]||a.A}function eb(a,b){b||(b=lb);ib(a,b,void 0);kb(a,b,void 0)}var lb=[],hb=[C.prototype.D,C.prototype.M,C.prototype.V,C.prototype.ha],jb=[C.prototype.B,C.prototype.H,C.prototype.T,C.prototype.$];
if(Pa)var gb=[C.prototype.o,C.prototype.G,C.prototype.N,C.prototype.Y],fb=[C.prototype.C,C.prototype.J,C.prototype.U,C.prototype.ga];
function mb(a,b){t.call(this,"CPU",a,mb);var c=a.cycles||b,d=a.multiplier||1;this.c={};this.c.na=c;this.c.Fa=0;this.c.ma=d;this.c.Ja=Math.round(this.c.na/1E4)/100;this.c.ja=this.c.Ja*this.c.ma;this.g.S=!1;this.g.Za=!1;this.g.Wa=a.autoStart;this.g.Ya=!1;this.g.za=!1;this.c.Da=this.c.la=0;this.c.Ea=a.csStart;this.c.ra=a.csInterval;this.c.sa=a.csStop;this.ib=this.Na.bind(this);B(this)}v(mb);var nb=["power","reset"];m=mb.prototype;
m.ca=function(a,b,c,d){this.v=a;this.w=b;this.I=d;for(b=0;b<nb.length;b++)(c=this.A[nb[b]])&&this.v.P(null,nb[b],c);this.Y=(b=Sa(a,"Video"))&&Math.max(b.Y,b.jb)||60;this.ha=Sa(a,"ChipSet");a=ob(a,"autoStart");null!=a&&(this.g.Wa="true"==a?!0:"false"==a?!1:!!a);B(this)};m.reset=function(){this.c.Fa=0};m.save=function(){return null};m.restore=function(){return!1};
m.X=function(a,b){if(!b){if(a&&this.restore){pb(this);if(!this.restore(a))return!1;qb(this)}else this.reset();this.O("No debugger detected")}rb(this);return!0};m.W=function(a){return a?this.save():!0};function sb(a){(a.g.Wa||void 0===a.A.run)&&a.Na()}m.$a=function(){return 0};function qb(a){void 0===a.c.Ea&&(a.c.Ea=0);void 0===a.c.ra&&(a.c.ra=-1);void 0===a.c.sa&&(a.c.sa=-1);a.g.za=0<=a.c.Ea&&0<a.c.ra;a.g.za&&(a.c.Da=0,a.c.la=a.c.Ea-a.V)}
m.P=function(a,b,c){var d=this;a=!1;switch(b){case "power":case "reset":this.A[b]=c;a=!0;break;case "run":this.A[b]=c;c.onclick=function(){var a;if(a=d.v)if(a=d.v,a.g.K)a=!0;else{var b=null,c,g=w(a.id);for(c=0;c<g.length&&(b=g[c],b===a||b.g.ia);c++);if(c==g.length)for(c=0;c<g.length&&(b=g[c],b===a||b.g.K);c++);c==g.length&&(b=a);q("The "+b.type+" component ("+b.id+") is not "+(b.g.ia?"powered yet":"ready yet"+(b.Ba?" (waiting for notification)":""))+".");a=!1}a&&(d.g.S?tb(d,!0):d.Na())};a=!0;break;
case "speed":this.A[b]=c;a=!0;break;case "setSpeed":this.A[b]=c,c.onclick=function(){ub(d,d.c.ma<<1)},c.textContent=this.c.ja.toFixed(2)+"Mhz",a=!0}return a};function vb(a,b,c){a.V+=b;c&&(a.U=a.a=0)}
function xb(a,b){var c=30;c<a.Y&&(c=a.Y);2>c&&(c=2);var d=1;b&&1<a.c.ma&&a.c.da&&(d=a.c.da/a.c.Ja);a.c.ab=Math.round(1E3/30);a.c.pb=Math.floor(a.c.na/c*d);a.c.Ka=Math.floor(a.c.na/30*d);a.c.cb=Math.floor(a.c.na/a.Y*d);a.c.bb=Math.floor(a.c.na/2*d);b||(a.c.va=a.c.Ka,a.c.ua=a.c.cb,a.c.ta=a.c.bb);a.c.La=0}function yb(a){return a.V+a.N+a.U-a.a}function pb(a){a.c.da=0;a.V=a.N=a.U=a.a=0;qb(a);ub(a,1)}
function ub(a,b){if(void 0!==b){.8>a.c.da/a.c.ja&&(b=1);a.c.ma=b;var c=a.c.Ja*a.c.ma;if(a.c.ja!=c){a.c.ja=c;var c=a.c.ja.toFixed(2)+"Mhz",d=a.A.setSpeed;d&&(d.textContent=c);a.O("target speed: "+c)}}vb(a,a.N);a.N=0;a.c.ka=ga();a.c.ea=0;xb(a)}
m.Na=function(){if(Na(this,!0)){if(!this.g.S){ub(this);this.v&&this.v.start(this.c.ka,yb(this));this.g.S=!0;this.g.Za=!0;this.ha&&this.ha.start();var a=this.A.run;a&&(a.textContent="Halt");this.v&&this.v.fa(!0)}this.c.La>=this.c.na&&xb(this,!0);this.c.wa=0;this.c.Ca=ga();this.c.ea&&(a=this.c.Ca-this.c.ea,a>this.c.ab&&(this.c.ka+=a,this.c.ka>this.c.Ca&&(this.c.ka=this.c.Ca)));try{do{var b=this.g.za?1:this.c.pb;try{this.gb(b)}catch(e){if("number"!=typeof e)throw e;}var c=this.U-this.a;this.N+=c;this.c.wa+=
c;vb(this,0,!0);a=c;if(this.g.za){var d=!1;this.c.Da=this.c.Da+this.$a()|0;this.c.la-=a;0>=this.c.la&&(this.c.la+=this.c.ra,d=!0);0<=this.c.sa&&this.c.sa<=yb(this)&&(this.c.ra=this.c.sa=-1,qb(this),tb(this),d=!0);d&&this.O(yb(this)+" cycles: checksum="+n(this.c.Da))}this.c.ua-=c;0>=this.c.ua&&(this.c.ua+=this.c.cb,this.v&&zb(this.v,this.c.Fa++),this.c.Fa>this.Y&&(this.c.Fa=0));this.c.ta-=c;0>=this.c.ta&&(this.c.ta+=this.c.bb,this.v&&this.v.fa());this.c.va-=c;if(0>=this.c.va){this.c.va+=this.c.Ka;
break}}while(this.g.S)}catch(e){tb(this);rb(this);this.v&&this.v.stop(ga(),yb(this));Na(this,!1);b=e.stack||e.message;this.g.ba=!0;this.L(b);return}b=setTimeout;c=this.ib;this.c.ea=ga();a=this.c.ab;this.c.wa&&(a=Math.round(a*this.c.wa/this.c.Ka));a-=this.c.ea-this.c.Ca;if(d=this.c.ea-this.c.ka)this.c.da=Math.round(this.N/(10*d))/100,864E5<=d&&(this.V=0,ub(this));if(0>a||this.c.da<this.c.ja)a=0;this.c.La+=this.c.wa;this.c.ea+=a;b(c,a)}else rb(this),this.v&&this.v.stop(ga(),yb(this))};m.gb=function(){return 0};
function tb(a,b){a.g.qa&&(a.g.Ia=!0);a.U-=a.a;a.a=0;vb(a,a.N);a.N=0;if(a.g.S){a.g.S=!1;a.ha&&a.ha.stop();var c=a.A.run;c&&(c.textContent="Run")}a.g.Aa=b}function rb(a){a.v&&(zb(a.v,-1),a.v.fa(void 0))}function Ab(a){this.aa=a.model||8080;mb.call(this,a,1E6);this.Pa=Bb;pb(this);this.g.Aa=this.g.kb=!1;this.Ra=0;this.M=[];this.C=this.H=this.T=this.Oa=this.Ha=this.$=0;this.ga=[];this.Qa=0;Cb(this)}v(Ab,mb);function Db(a,b){a.ga.push(b)}m=Ab.prototype;
m.reset=function(){this.g.S&&tb(this);Cb(this);pb(this);this.g.ba=!1;this.parent.reset.call(this)};function Cb(a){a.b=0;a.h=0;a.s=0;a.i=0;a.u=0;a.j=0;a.l=0;a.B=0;D(a,a.Qa);Eb(a,0);a.G=0}function Fb(a,b){a.Qa=b;D(a,b)}m.$a=function(){var a=this.b+this.h+this.s+this.i+this.u+this.j+this.l|0;return a=a+this.B+this.m+Gb(this)|0};
m.save=function(){var a=new E(this);F(a,0,[this.b,this.h,this.s,this.i,this.u,this.j,this.l,this.B,this.m,Gb(this)]);F(a,1,[this.G,this.V,this.c.ma]);for(var b=this.w,c=0,d=[],e=0;e<b.f;e++){var f=b.b[e];if(f.R||f.Xa){d[c++]=e;var h=c++;a:if(f=f.save()){for(var g=0,k=0,l=[];g<f.length;){for(var x=f[g],r=g+1;r<f.length&&f[r]===x;)r++;l[k++]=r-g;l[k++]=x;g=r}if(l.length<f.length){f=l;break a}}d[h]=f}}F(a,2,d);return a.data()};
m.restore=function(a){var b=a[0];this.b=b[0];this.h=b[1];this.s=b[2];this.i=b[3];this.u=b[4];this.j=b[5];this.l=b[6];this.B=b[7]&65535;D(this,b[8]);Eb(this,b[9]);b=a[1];this.G=b[0];this.V=b[1];ub(this,b[3]);a:{b=this.w;a=a[2];var c;for(c=0;c<a.length-1;c+=2){var d=a[c],e=a[c+1];if(e&&e.length<b.w){for(var f=0,h=Array(b.w),g=0;g<e.length-1;)for(var k=e[g++],l=e[g++];k--;)h[f++]=l;e=h}f=b.b[d];if(!f||!f.restore(e)){q("Unable to restore memory block "+d);b=!1;break a}}b=!0}return b};
m.P=function(a,b,c){var d=!1;switch(b){case "A":case "B":case "C":case "BC":case "D":case "E":case "DE":case "H":case "L":case "HL":case "SP":case "PC":case "PS":case "SF":case "ZF":case "AF":case "PF":case "CF":this.A[b]=c;this.Ra++;d=!0;break;default:d=this.parent.P.call(this,a,b,c)}return d};function Hb(a){return a.h<<8|a.s}function Ib(a,b){a.h=b>>8&255;a.s=b&255}function G(a){return a.i<<8|a.u}function Jb(a,b){a.i=b>>8&255;a.u=b&255}function H(a){return a.j<<8|a.l}
function I(a,b){a.j=b>>8&255;a.l=b&255}function D(a,b){a.m=b&65535}function J(a){return a.f&256?1:0}function Kb(a){return Qa[a.o&255]?4:0}function Gb(a){return a.J&-214|(a.o&128?128:0)|(a.f&255?0:64)|((a.o^a.D)&16?16:0)|Kb(a)|J(a)}function Eb(a,b){a.f=a.o=a.D=0;b&1&&(a.f|=256);b&4||(a.o|=1);b&16&&(a.D|=16);b&64||(a.f|=255);b&128&&(a.o^=192);a.J=a.J&-513|b&512|2}function K(a,b){a.D=a.b^b;return a.o=(a.f=a.b+b)&255}function L(a,b){a.D=a.b^b;return a.o=(a.f=a.b+b+(a.f&256?1:0))&255}
function M(a,b){a.f=a.o=a.D=a.b&b;(a.b|b)&8&&(a.D^=16);return a.f}function Lb(a,b){a.D=b^255;b=a.o=b+255&255;a.f=a.f&-256|b;return b}function Mb(a,b){a.D=b;b=a.o=b+1&255;a.f=a.f&-256|b;return b}function N(a,b){return a.o=a.f=a.D=a.b|b}function O(a,b){b^=255;a.D=a.b^b;return a.o=(a.f=a.b+b+1^256)&255}function P(a,b){b^=255;a.D=a.b^b;return a.o=(a.f=a.b+b+(a.f&256?0:1)^256)&255}function Q(a,b){return a.o=a.f=a.D=a.b^b}m.F=function(a){return this.M[(a&this.$)>>>this.C].oa(a&this.T,a)};
function Nb(a,b){var c=b&a.T,d=(b&a.$)>>>a.C;if(c<a.T)return a.M[d].vb(c,b);c=a.M[d].oa(c,b);return c|=a.M[d+1&a.Ha].oa(0,b+1)<<8}function R(a,b,c){a.M[(b&a.$)>>>a.C].ya(b&a.T,c&255,b)}function Ob(a,b,c){var d=b&a.T,e=(b&a.$)>>>a.C;d<a.T?a.M[e].wb(d,c&65535,b):(a.M[e++].ya(d,c&255,b),a.M[e&a.Ha].ya(0,c>>8&255,b+1))}function S(a){var b=a.F(a.m);D(a,a.m+1);return b}function T(a){var b=Nb(a,a.m);D(a,a.m+2);return b}function U(a){var b=Nb(a,a.B);a.B=a.B+2&65535;return b}
function V(a,b){a.B=a.B-2&65535;Ob(a,a.B,b)}function W(a,b,c,d){d=d||2;a.A[b]&&(void 0===c&&(a.g.ba=!0,a.L("Value for "+b+" is invalid"),tb(a)),c=!a.g.S||a.g.Ya?n(c,d):"--------".substr(0,d),a.A[b].textContent!=c&&(a.A[b].textContent=c))}
m.fa=function(a){this.Ra&&(a||!this.g.S||this.g.Ya)&&(W(this,"A",this.b),W(this,"B",this.h),W(this,"C",this.s),W(this,"BC",Hb(this),4),W(this,"D",this.i),W(this,"E",this.u),W(this,"DE",G(this),4),W(this,"H",this.j),W(this,"L",this.l),W(this,"HL",H(this),4),W(this,"SP",this.B,4),W(this,"PC",this.m,4),a=Gb(this),W(this,"PS",a,4),W(this,"SF",a&128?1:0,1),W(this,"ZF",a&64?1:0,1),W(this,"AF",a&16?1:0,1),W(this,"PF",a&4?1:0,1),W(this,"CF",a&1?1:0,1));if(a=this.A.speed)a.textContent=this.g.S&&this.c.da?
this.c.da.toFixed(2)+"Mhz":"Stopped"};m.gb=function(a){this.g.Aa=!0;this.g.kb=!1;this.g.Za=!1;this.U=this.a=a;do{if(a=this.G)this.G&8&&this.J&512?(a=199|(this.G&7)<<3,this.G&=-16,this.J&=-513,this.Pa[a].call(this),a=!0):a=!1,a=!a;if(a&&this.G&16){this.a=0;break}this.Pa[S(this)].call(this)}while(0<this.a);return this.g.Aa?this.U-this.a:void 0===this.g.Aa?0:-1};xa(function(){for(var a=z(document,"pc8080","cpu"),b=0;b<a.length;b++){var c=a[b],d=y(c),d=new Ab(d);Ma(d,c)}});function Pb(){this.a-=4}
function Qb(){D(this,T(this));this.a-=10}function Rb(){D(this,U(this));this.a-=10}function Sb(){var a=T(this);V(this,this.m);D(this,a);this.a-=17}
var Bb=[Pb,function(){Ib(this,T(this));this.a-=10},function(){R(this,Hb(this),this.b);this.a-=7},function(){Ib(this,Hb(this)+1);this.a-=5},function(){this.h=Mb(this,this.h);this.a-=5},function(){this.h=Lb(this,this.h);this.a-=5},function(){this.h=S(this);this.a-=7},function(){var a=this.b<<1;this.b=a&255|a>>8;this.f=this.f&255|a&256;this.a-=4},Pb,function(){var a;I(this,a=H(this)+Hb(this));this.f=this.f&255|a>>8&256;this.a-=10},function(){this.b=this.F(Hb(this));this.a-=7},function(){Ib(this,Hb(this)-
1);this.a-=5},function(){this.s=Mb(this,this.s);this.a-=5},function(){this.s=Lb(this,this.s);this.a-=5},function(){this.s=S(this);this.a-=7},function(){var a=this.b<<8&256;this.b=(a|this.b)>>1;this.f=this.f&255|a;this.a-=4},Pb,function(){Jb(this,T(this));this.a-=10},function(){R(this,G(this),this.b);this.a-=7},function(){Jb(this,G(this)+1);this.a-=5},function(){this.i=Mb(this,this.i);this.a-=5},function(){this.i=Lb(this,this.i);this.a-=5},function(){this.i=S(this);this.a-=7},function(){var a=this.b<<
1;this.b=a&255|this.f>>8;this.f=this.f&255|a&256;this.a-=4},Pb,function(){var a;I(this,a=H(this)+G(this));this.f=this.f&255|a>>8&256;this.a-=10},function(){this.b=this.F(G(this));this.a-=7},function(){Jb(this,G(this)-1);this.a-=5},function(){this.u=Mb(this,this.u);this.a-=5},function(){this.u=Lb(this,this.u);this.a-=5},function(){this.u=S(this);this.a-=7},function(){var a=this.b<<8&256;this.b=(this.f&256|this.b)>>1;this.f=this.f&255|a;this.a-=4},Pb,function(){I(this,T(this));this.a-=10},function(){Ob(this,
T(this),H(this));this.a-=16},function(){I(this,H(this)+1);this.a-=5},function(){this.j=Mb(this,this.j);this.a-=5},function(){this.j=Lb(this,this.j);this.a-=5},function(){this.j=S(this);this.a-=7},function(){var a=0,b=J(this);if((this.o^this.D)&16||9<(this.b&15))a|=6;if(b||154<=this.b)a|=96,b=1;this.b=K(this,a);this.f=b?this.f|256:this.f&-257;this.a-=4},Pb,function(){var a;I(this,a=H(this)+H(this));this.f=this.f&255|a>>8&256;this.a-=10},function(){I(this,Nb(this,T(this)));this.a-=16},function(){I(this,
H(this)-1);this.a-=5},function(){this.l=Mb(this,this.l);this.a-=5},function(){this.l=Lb(this,this.l);this.a-=5},function(){this.l=S(this);this.a-=7},function(){this.b=~this.b&255;this.a-=4},Pb,function(){this.B=T(this)&65535;this.a-=10},function(){R(this,T(this),this.b);this.a-=13},function(){this.B=this.B+1&65535;this.a-=5},function(){var a=H(this);R(this,a,Mb(this,this.F(a)));this.a-=10},function(){var a=H(this);R(this,a,Lb(this,this.F(a)));this.a-=10},function(){R(this,H(this),S(this));this.a-=
10},function(){this.f|=256;this.a-=4},Pb,function(){var a;I(this,a=H(this)+this.B);this.f=this.f&255|a>>8&256;this.a-=10},function(){this.b=this.F(T(this));this.a-=13},function(){this.B=this.B-1&65535;this.a-=5},function(){this.b=Mb(this,this.b);this.a-=5},function(){this.b=Lb(this,this.b);this.a-=5},function(){this.b=S(this);this.a-=7},function(){this.f=J(this)?this.f&-257:this.f|256;this.a-=4},function(){this.a-=5},function(){this.h=this.s;this.a-=5},function(){this.h=this.i;this.a-=5},function(){this.h=
this.u;this.a-=5},function(){this.h=this.j;this.a-=5},function(){this.h=this.l;this.a-=5},function(){this.h=this.F(H(this));this.a-=7},function(){this.h=this.b;this.a-=5},function(){this.s=this.h;this.a-=5},function(){this.a-=5},function(){this.s=this.i;this.a-=5},function(){this.s=this.u;this.a-=5},function(){this.s=this.j;this.a-=5},function(){this.s=this.l;this.a-=5},function(){this.s=this.F(H(this));this.a-=7},function(){this.s=this.b;this.a-=5},function(){this.i=this.h;this.a-=5},function(){this.i=
this.s;this.a-=5},function(){this.a-=5},function(){this.i=this.u;this.a-=5},function(){this.i=this.j;this.a-=5},function(){this.i=this.l;this.a-=5},function(){this.i=this.F(H(this));this.a-=7},function(){this.i=this.b;this.a-=5},function(){this.u=this.h;this.a-=5},function(){this.u=this.s;this.a-=5},function(){this.u=this.i;this.a-=5},function(){this.a-=5},function(){this.u=this.j;this.a-=5},function(){this.u=this.l;this.a-=5},function(){this.u=this.F(H(this));this.a-=7},function(){this.u=this.b;
this.a-=5},function(){this.j=this.h;this.a-=5},function(){this.j=this.s;this.a-=5},function(){this.j=this.i;this.a-=5},function(){this.j=this.u;this.a-=5},function(){this.a-=5},function(){this.j=this.l;this.a-=5},function(){this.j=this.F(H(this));this.a-=7},function(){this.j=this.b;this.a-=5},function(){this.l=this.h;this.a-=5},function(){this.l=this.s;this.a-=5},function(){this.l=this.i;this.a-=5},function(){this.l=this.u;this.a-=5},function(){this.l=this.j;this.a-=5},function(){this.a-=5},function(){this.l=
this.F(H(this));this.a-=7},function(){this.l=this.b;this.a-=5},function(){R(this,H(this),this.h);this.a-=7},function(){R(this,H(this),this.s);this.a-=7},function(){R(this,H(this),this.i);this.a-=7},function(){R(this,H(this),this.u);this.a-=7},function(){R(this,H(this),this.j);this.a-=7},function(){R(this,H(this),this.l);this.a-=7},function(){var a=this.m-1;if(this.ga.length)for(var b=0;b<this.ga.length;b++)if(this.ga[b](a))return;this.G|=16;this.a-=7;this.J&512||tb(this)},function(){R(this,H(this),
this.b);this.a-=7},function(){this.b=this.h;this.a-=5},function(){this.b=this.s;this.a-=5},function(){this.b=this.i;this.a-=5},function(){this.b=this.u;this.a-=5},function(){this.b=this.j;this.a-=5},function(){this.b=this.l;this.a-=5},function(){this.b=this.F(H(this));this.a-=7},function(){this.a-=5},function(){this.b=K(this,this.h);this.a-=4},function(){this.b=K(this,this.s);this.a-=4},function(){this.b=K(this,this.i);this.a-=4},function(){this.b=K(this,this.u);this.a-=4},function(){this.b=K(this,
this.j);this.a-=4},function(){this.b=K(this,this.l);this.a-=4},function(){this.b=K(this,this.F(H(this)));this.a-=7},function(){this.b=K(this,this.b);this.a-=4},function(){this.b=L(this,this.h);this.a-=4},function(){this.b=L(this,this.s);this.a-=4},function(){this.b=L(this,this.i);this.a-=4},function(){this.b=L(this,this.u);this.a-=4},function(){this.b=L(this,this.j);this.a-=4},function(){this.b=L(this,this.l);this.a-=4},function(){this.b=L(this,this.F(H(this)));this.a-=7},function(){this.b=L(this,
this.b);this.a-=4},function(){this.b=O(this,this.h);this.a-=4},function(){this.b=O(this,this.s);this.a-=4},function(){this.b=O(this,this.i);this.a-=4},function(){this.b=O(this,this.u);this.a-=4},function(){this.b=O(this,this.j);this.a-=4},function(){this.b=O(this,this.l);this.a-=4},function(){this.b=O(this,this.F(H(this)));this.a-=7},function(){this.b=O(this,this.b);this.a-=4},function(){this.b=P(this,this.h);this.a-=4},function(){this.b=P(this,this.s);this.a-=4},function(){this.b=P(this,this.i);
this.a-=4},function(){this.b=P(this,this.u);this.a-=4},function(){this.b=P(this,this.j);this.a-=4},function(){this.b=P(this,this.l);this.a-=4},function(){this.b=P(this,this.F(H(this)));this.a-=7},function(){this.b=P(this,this.b);this.a-=4},function(){this.b=M(this,this.h);this.a-=4},function(){this.b=M(this,this.s);this.a-=4},function(){this.b=M(this,this.i);this.a-=4},function(){this.b=M(this,this.u);this.a-=4},function(){this.b=M(this,this.j);this.a-=4},function(){this.b=M(this,this.l);this.a-=
4},function(){this.b=M(this,this.F(H(this)));this.a-=7},function(){this.b=M(this,this.b);this.a-=4},function(){this.b=Q(this,this.h);this.a-=4},function(){this.b=Q(this,this.s);this.a-=4},function(){this.b=Q(this,this.i);this.a-=4},function(){this.b=Q(this,this.u);this.a-=4},function(){this.b=Q(this,this.j);this.a-=4},function(){this.b=Q(this,this.l);this.a-=4},function(){this.b=Q(this,this.F(H(this)));this.a-=7},function(){this.b=Q(this,this.b);this.a-=4},function(){this.b=N(this,this.h);this.a-=
4},function(){this.b=N(this,this.s);this.a-=4},function(){this.b=N(this,this.i);this.a-=4},function(){this.b=N(this,this.u);this.a-=4},function(){this.b=N(this,this.j);this.a-=4},function(){this.b=N(this,this.l);this.a-=4},function(){this.b=N(this,this.F(H(this)));this.a-=7},function(){this.b=N(this,this.b);this.a-=4},function(){O(this,this.h);this.a-=4},function(){O(this,this.s);this.a-=4},function(){O(this,this.i);this.a-=4},function(){O(this,this.u);this.a-=4},function(){O(this,this.j);this.a-=
4},function(){O(this,this.l);this.a-=4},function(){O(this,this.F(H(this)));this.a-=7},function(){O(this,this.b);this.a-=4},function(){this.f&255&&(D(this,U(this)),this.a-=6);this.a-=5},function(){Ib(this,U(this));this.a-=10},function(){var a=T(this);this.f&255&&D(this,a);this.a-=10},Qb,function(){var a=T(this);this.f&255&&(V(this,this.m),D(this,a),this.a-=6);this.a-=11},function(){V(this,Hb(this));this.a-=11},function(){this.b=K(this,S(this));this.a-=7},function(){V(this,this.m);D(this,0);this.a-=
11},function(){this.f&255||(D(this,U(this)),this.a-=6);this.a-=5},Rb,function(){var a=T(this);this.f&255||D(this,a);this.a-=10},Qb,function(){var a=T(this);this.f&255||(V(this,this.m),D(this,a),this.a-=6);this.a-=11},Sb,function(){this.b=L(this,S(this));this.a-=7},function(){V(this,this.m);D(this,8);this.a-=11},function(){J(this)||(D(this,U(this)),this.a-=6);this.a-=5},function(){Jb(this,U(this));this.a-=10},function(){var a=T(this);J(this)||D(this,a);this.a-=10},function(){for(var a=S(this),b=this.w,
c=this.b,d=this.m+-2&65535,e=1,f=0;0<e;){var h=b.l[a],g=b.B[a]||1,k=1==g?255:2==g?65535:-1,k=(c>>>=f)&k;if(void 0!==h&&h[0])h[0](a,k,d);f+=g<<3;a+=g;e-=g}this.a-=10},function(){var a=T(this);J(this)||(V(this,this.m),D(this,a),this.a-=6);this.a-=11},function(){V(this,G(this));this.a-=11},function(){this.b=O(this,S(this));this.a-=7},function(){V(this,this.m);D(this,16);this.a-=11},function(){J(this)&&(D(this,U(this)),this.a-=6);this.a-=5},Rb,function(){var a=T(this);J(this)&&D(this,a);this.a-=10},function(){for(var a=
S(this),b=this.w,c=this.m+-2&65535,d=1,e=0,f=0;0<d;){var h=b.j[a],g=b.o[a]||1,k=1==g?255:2==g?65535:-1,l=k;void 0!==h&&h[0]&&(l=h[0](a,c),void 0===l?l=k:l&=k);e|=l<<f;f+=g<<3;a+=g;d-=g}this.b=e&255;this.a-=10},function(){var a=T(this);J(this)&&(V(this,this.m),D(this,a),this.a-=6);this.a-=11},Sb,function(){this.b=P(this,S(this));this.a-=7},function(){V(this,this.m);D(this,24);this.a-=11},function(){Kb(this)||(D(this,U(this)),this.a-=6);this.a-=5},function(){I(this,U(this));this.a-=10},function(){var a=
T(this);Kb(this)||D(this,a);this.a-=10},function(){var a=U(this);V(this,H(this));I(this,a);this.a-=18},function(){var a=T(this);Kb(this)||(V(this,this.m),D(this,a),this.a-=6);this.a-=11},function(){V(this,H(this));this.a-=11},function(){this.b=M(this,S(this));this.a-=7},function(){V(this,this.m);D(this,32);this.a-=11},function(){Kb(this)&&(D(this,U(this)),this.a-=6);this.a-=5},function(){D(this,H(this));this.a-=5},function(){var a=T(this);Kb(this)&&D(this,a);this.a-=10},function(){var a=H(this);I(this,
G(this));Jb(this,a);this.a-=5},function(){var a=T(this);Kb(this)&&(V(this,this.m),D(this,a),this.a-=6);this.a-=11},Sb,function(){this.b=Q(this,S(this));this.a-=7},function(){V(this,this.m);D(this,40);this.a-=11},function(){this.o&128||(D(this,U(this)),this.a-=6);this.a-=5},function(){var a=U(this);Eb(this,a);this.b=a>>8;this.a-=10},function(){var a=T(this);this.o&128||D(this,a);this.a-=10},function(){this.J&=-513;this.a-=4},function(){var a=T(this);this.o&128||(V(this,this.m),D(this,a),this.a-=6);
this.a-=11},function(){V(this,Gb(this)&255|this.b<<8);this.a-=11},function(){this.b=N(this,S(this));this.a-=7},function(){V(this,this.m);D(this,48);this.a-=11},function(){this.o&128&&(D(this,U(this)),this.a-=6);this.a-=5},function(){this.B=H(this)&65535;this.a-=5},function(){var a=T(this);this.o&128&&D(this,a);this.a-=10},function(){this.J|=512;this.a-=4},function(){var a=T(this);this.o&128&&(V(this,this.m),D(this,a),this.a-=6);this.a-=11},Sb,function(){O(this,S(this));this.a-=7},function(){V(this,
this.m);D(this,56);this.a-=11}];function X(a){t.call(this,"ChipSet",a,X);var b=a.model;b&&!Tb[b]&&q("Unrecognized ChipSet model: "+b);this.aa=Tb[b]||Ub;a.sound&&(this.m=null,window&&(this.m=window.AudioContext||window.webkitAudioContext),this.m&&new this.m);B(this)}v(X);var Ub=1978.1,Tb={SI1978:Ub};m=X.prototype;m.P=function(){return!1};
m.ca=function(a,b,c,d){this.w=b;this.a=c;this.I=d;this.v=a;if(this.aa==Ub){var e;a=Vb;void 0===e&&(e=0);for(var f in a){c=b;d=+f+e;var h=a[f].bind(this);if(void 0!==h)for(var g=+f+e;g<=d;g++)void 0!==c.j[g]?q("Input port 0x"+n(g,4)+" already registered"):c.j[g]=[h,!1]}var k;e=Wb;void 0===k&&(k=0);for(var l in e)if(f=b,a=+l+k,c=e[l].bind(this),void 0!==c)for(d=+l+k;d<=a;d++)void 0!==f.l[d]?q("Output port 0x"+n(d,4)+" already registered"):f.l[d]=[c,!1]}};
m.X=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};m.W=function(a){return a?this.save():!0};m.reset=function(){this.f=this.h=this.c=this.b=this.l=this.j=this.i=0};m.save=function(){var a=new E(this);this.aa==Ub&&F(a,0,[this.i,this.j,this.l,this.b,this.c,this.f,this.h]);return a.data()};m.restore=function(a){a=a[0];this.aa==Ub&&(this.i=a[0],this.j=a[1],this.l=a[2],this.b=a[3],this.c=a[4],this.f=a[5],this.h=a[6]);return!0};m.start=function(){};m.stop=function(){};
m.mb=function(){return this.i};m.nb=function(){return this.j};m.ob=function(){return this.l};m.lb=function(){return this.b>>8-this.c&255};m.qb=function(a,b){this.c=b};m.sb=function(a,b){this.f=b};m.rb=function(a,b){this.b=b<<8|this.b>>8};m.tb=function(a,b){this.h=b};m.ub=function(){};var Vb={0:X.prototype.mb,1:X.prototype.nb,2:X.prototype.ob,3:X.prototype.lb},Wb={2:X.prototype.qb,3:X.prototype.sb,4:X.prototype.rb,5:X.prototype.tb,6:X.prototype.ub};
xa(function(){for(var a=z(document,"pc8080","chipset"),b=0;b<a.length;b++){var c=a[b],d=y(c),d=new X(d);Ma(d,c)}});function Xb(a){t.call(this,"ROM",a,Xb);this.b=null;this.j=a.addr;this.c=a.size;this.l=a.writable;this.f=a.alias;this.h=a.file;this.m=ba(this.h);if(this.h){a=this.h;var b=ca(this.m);"json"!=b&&"hex"!=b&&(a=ja()+"/api/v1/dump?file="+this.h+"&format=bytes&decimal=true");var c=this;p(a,null,!0,function(a,b,f){Yb(c,a,b,f)})}}v(Xb);var Zb=[0,5];
Xb.prototype.ca=function(a,b,c,d){this.w=b;this.a=c;this.I=d;$b(this)};Xb.prototype.X=function(){this.i&&(this.I&&this.I.a(this.id,this.j,this.c,this.i),delete this.i);return!0};Xb.prototype.W=function(){return!0};
function Yb(a,b,c,d){if(d)a.L("Unable to load system ROM (error "+d+": "+b+")");else{Ka(a.Ua,b,c);if("["==c.charAt(0)||"{"==c.charAt(0))try{var e=eval("("+c+")"),f=e.bytes,h=e.data;if(f)a.b=f;else if(h)for(a.b=Array(4*h.length),d=c=0;c<h.length;c++)a.b[d++]=h[c]&255,a.b[d++]=h[c]>>8&255,a.b[d++]=h[c]>>16&255,a.b[d++]=h[c]>>24&255;else a.b=e;a.i=e.symbols;if(!a.b.length){q("Empty ROM: "+b);return}if(1==a.b.length){q(a.b[0]);return}}catch(g){a.L("ROM data error: "+g.message);return}else for(b=c.replace(/\n/gm,
" ").replace(/ +$/,"").split(" "),a.b=Array(b.length),e=0;e<b.length;e++)a.b[e]=aa(b[e]);$b(a)}}
function $b(a){if(!Oa(a))if(!a.h)B(a);else if(a.b&&a.w){a.c||(a.c=a.b.length);if(a.b.length!=a.c){var b="ROM size (0x"+n(a.b.length)+") does not match specified size ("+("0x"+n(a.c))+")";a.g.ba=!0;a.L(b)}else if(ac(a,a.j)){b=[];"number"==typeof a.f?b.push(a.f):null!=a.f&&a.f.length&&(b=a.f);for(var c=0;c<b.length;c++){for(var d=a,e=b[c],f=d.w,h=d.c,g=[],k=d.j>>>f.C;0<h&&k<f.b.length;)g.push(f.b[k++]),h-=f.H;f=d.w;d=d.c;h=0;for(e>>>=f.C;0<d&&e<f.b.length;){k=g[h++];if(!k)break;f.b[e++]=k;d-=f.H}}delete a.b}B(a)}}
function ac(a,b){if(Wa(a.w,b,a.c,a.l?1:db)){var c;for(c=0;c<a.b.length;c++)Ya(a.w,b+c,a.b[c]);if(a.l&&256==b){for(c=0;c<Zb.length;c++)Ya(a.w,Zb[c],118);Db(a.a,function(a){return function(b){if(0<=Zb.indexOf(b)){var c=!1,h=a.a,g=a.I;if(5==b)switch(c=!0,h.s){case 2:bc(a,String.fromCharCode(h.u));break;case 9:for(var k=G(h),l="",x=255;x--;){var r=a.a.F(k++);if(36==r)break;l+=String.fromCharCode(r)}bc(a,l);break;default:c=!1}c?Rb.call(h):g&&(a.O("\nCP/M vector 0x"+n(b,4)),D(h,b),tb(g));b=!0}else b=!1;
return b}}(a));Fb(a.a,b)}return!0}return!1}function bc(a,b){b=b.replace(/\r/g,"");a.Z&&(a.Z.value+=b,a.Z.scrollTop=a.Z.scrollHeight)}xa(function(){for(var a=z(document,"pc8080","rom"),b=0;b<a.length;b++){var c=a[b],d=y(c),d=new Xb(d);Ma(d,c)}});function cc(a){t.call(this,"RAM",a,cc);this.f=a.addr;this.c=a.size;this.b=!1}v(cc);m=cc.prototype;m.ca=function(a,b,c,d){this.w=b;this.a=c;this.I=d;B(this)};m.X=function(a,b){b||this.reset();return!0};m.W=function(a){return a?this.save():!0};
m.reset=function(){!this.b&&this.c&&Wa(this.w,this.f,this.c,1)&&(this.b=!0,this.status(Math.floor(this.c/1024)+"Kb allocated"));this.b||q("No RAM allocated")};m.save=function(){return null};m.restore=function(){return!0};xa(function(){for(var a=z(document,"pc8080","ram"),b=0;b<a.length;b++){var c=a[b],d=y(c),d=new cc(d);Ma(d,c)}});function dc(a){t.call(this,"Keyboard",a,dc);B(this)}v(dc);
xa(function(){for(var a=z(document,"pc8080","keyboard"),b=0;b<a.length;b++){var c=a[b],d=y(c),d=new dc(d);Ma(d,c)}});
function ec(a,b,c){t.call(this,"Video",a,ec);this.J=a.screenWidth;this.M=a.screenHeight;this.j=a.bufferAddr;this.b=a.bufferCols;this.c=a.bufferRows;this.B=a.bufferBits||1;this.jb=a.interruptRate;this.Y=a.refreshRate||60;this.m=c;this.G=[[0,0,0,255],[255,255,255,255]];this.o=this.m.createImageData(this.b,this.c);this.h=document.createElement("canvas");this.h.width=this.b;this.h.height=this.c;this.H=this.h.getContext("2d")}v(ec);
ec.prototype.ca=function(a,b,c,d){this.v=a;this.w=b;this.a=c;this.I=d;this.i=(this.b*this.B>>3)*this.c;Wa(this.w,this.j,this.i,3)&&(this.C=this.i>>1,this.D=16/this.B|0,this.l=!1,void 0===this.f||this.f.length!=this.C)&&(this.f=Array(this.C));B(this)};
xa(function(){for(var a=z(document,"pc8080","video"),b=0;b<a.length;b++){var c=a[b],d=y(c),e=document.createElement("canvas");if(void 0===e||!e.getContext){c.innerHTML="<br/>Missing &lt;canvas&gt; support. Please try a newer web browser.";break}e.setAttribute("class","pcjs-canvas");e.setAttribute("width",d.screenWidth);e.setAttribute("height",d.screenHeight);e.style.backgroundColor=d.screenColor;e.style.height="auto";0<=(window?window.navigator.userAgent:"").indexOf("MSIE")&&(c.onresize=function(a,
b,c,d){return function(){b.style.height=(a.clientWidth*d/c|0)+"px"}}(c,e,d.screenWidth,d.screenHeight),c.onresize());var f=+(d.aspect||Ca.aspect);f&&.3<=f&&3.33>=f&&(wa("onresize",function(a,b,c){return function(){b.style.height=(a.clientWidth/c|0)+"px"}}(c,e,f)),window.onresize());c.appendChild(e);f=document.createElement("textarea");qa("iOS")&&(f.setAttribute("autocapitalize","off"),f.setAttribute("autocorrect","off"));c.appendChild(f);e=e.getContext("2d");d=new ec(d,0,e);Ma(d,c)}});
function E(a,b,c){this.id=a.id;this.key=fc(a,b,c);this.I=a.I;gc(this,a.eb)}function fc(a,b,c){a=a.id;if(b){var d=b.indexOf(".");0<d&&(a+=".v"+b.substr(0,d))}c&&(a+="."+c);return a}
E.prototype={constructor:E,value:function(){return this[this.id]},data:function(){return this[this.id]},toString:function(){var a=this[this.id];return"string"==typeof a?a:JSON.stringify(a)},clear:function(a){gc(this);var b=[];try{for(var c=0,d=window.localStorage.length;c<d;c++)b.push(window.localStorage.key(c))}catch(e){}for(c=0;c<b.length;c++)if((d=b[c])&&(a||d.substr(0,this.key.length)==this.key)){try{window.localStorage.removeItem(d)}catch(e){}b.splice(c,1);c=0}}};
function gc(a,b){a[a.id]={};b&&F(a,"parms",b);a.a=!1}function hc(a){var b=!0;if(na()){var c=JSON.stringify(a[a.id]);pa(a.key,c)||(q("Unable to store "+c.length+" bytes in browser local storage"),b=!1)}return b}function ic(a){var b=!0;try{a[a.id]=JSON.parse(a[a.id])}catch(c){q(c.message||c),b=!1}return b}function jc(a,b){return b?(a[a.id]=b,a.a=!0):a.a?!0:na()&&(b=oa(a.key))?(a[a.id]=b,a.a=!0):!1}function kc(a,b){return a[a.id][b]||null}function F(a,b,c){try{a[a.id][b]=c}catch(d){}}
function lc(a,b,c){t.call(this,"Computer",a,lc);this.g.K=!1;mc(this,b);this.C=ob(this,"autoPower",a);this.f=0;this.M=a.busWidth||a.buswidth;this.b=nc;this.v=null;this.j=this.J=!1;this.N=ob(this,"url")||"";(Math.random()+.1).toString(36);this.c=oc(this);if(this.a=La("CPU",this.id)){this.I=La("Debugger",this.id);this.B=[];for(b=null;b=Sa(this,"Video",b);)this.B.push(b);this.w=new Ua({id:this.Ua+".bus",busWidth:this.M},this.a,this.I);var d,e=w(this.id);if((this.h=La("Panel",this.id))&&this.h.Z)for(b=
0;b<e.length;b++)d=e[b],d.L=this.h.L,d.O=this.h.O,d.Z=this.h.Z;for(b=0;b<e.length;b++)d=e[b],d.ca&&d.ca(this,this.w,this.a,this.I);b=null;d=a.resume;void 0!==d&&(1<d.length?b=this.m=d:this.b=parseInt(d,10));var f;if(a=ob(this,"state")||(f=!0,a.state))b=this.D=a,f||(this.j=!0,this.b=nc),this.b&&(this.o=new E(this,Y),jc(this.o)?b=null:delete this.o);!b&&this.b&&(b=pc(this))&&(this.j=!0);if(b){var h=this;p(b,null,!0,function(a,b,c){c?(h.m=null,h.j=!1,h.L("Unable to load machine state from server (error "+
c+(b?": "+(String.prototype.trim?b.trim():b.replace(/^\s+|\s+$/g,"")):"")+")")):(h.v=b,h.J=!0);B(h)})}else B(this);this.A.power||(this.C=!0);!c&&this.C&&qc(this,this.xa)}else q("Unable to find CPU component")}v(lc);var Y="1.22.0",nc=0;function mc(a,b){if(!b){var c;if("object"==typeof resources&&(c=resources.parms))try{b=eval("("+c+")")}catch(d){q(d.message+" ("+c+")")}}a.l=b}
function ob(a,b,c){var d=b.toLowerCase(),d=Ca[b]||Ca[d];void 0===d&&a.l&&(d=a.l[b]);void 0===d&&c&&(d=c[b]);void 0===d&&"object"==typeof resources&&resources[b]&&(d=b);return d}function qc(a,b,c){for(var d=w(a.id),e=0;e<=d.length;e++){var f=e<d.length?d[e]:a;if(!Oa(f)){Oa(f,function(){qc(a,b,c)});return}}b.call(a,c)}
function rc(a,b){var c=new E(a,Y,"validate");if(jc(c)&&ic(c)){var d=kc(c,"timestamp"),e=b?kc(b,"timestamp"):"unknown";d!=e&&(a.L("Machine state may be out-of-date\n("+d+" vs. "+e+")\nCheck your browser's local storage limits"),b||c.clear())}}m=lc.prototype;
m.xa=function(a){void 0===a&&(a=this.b||(this.v?1:nc));if(!this.f){this.f++;var b=!1,c=!1;this.H=!1;var d=this.o||new E(this,Y);if(-1==a)b=!0;else if(a>nc){if(jc(d,this.v)){this.i=new E(this,Y,"failsafe");jc(this.i)&&(sc(this,d),a=2,gc(this.i));F(this.i,"timestamp",ia());hc(this.i);var e=this.b&&!this.j;if(1==a||ka("Click OK to restore the previous PC8080 machine state, or CANCEL to reset the machine.")){if(c=ic(d)){var f=kc(d,"code"),h=kc(d,"data");f&&("ok"==f?jc(d,h):("error"==f&&"no machine state"!=
h?(this.L("Error: "+h),"unable to verify user"==h&&(pa("user",""),this.c=null)):this.O(f+": "+h),gc(d),jc(d)?(c=ic(d),e=!0):c=!1))}e&&rc(this,c?d:null)}else 2==a&&d.clear()}else rc(this);delete this.v;delete this.o}e=w(this.id);for(f=0;f<e.length;f++)h=e[f],h!==this&&h!=this.a&&(c=tc(this,h,d,b,c));b=[d,a,c];-1!=a?qc(this,this.Va,b):this.Va(b)}};
function tc(a,b,c,d,e){if(!b.g.K){b.g.K=!0;if(b.X){var f=null;e&&((f=kc(c,b.id))||(f=kc(c,b.id.replace(/[a-z0-9]\./i,"."))));"string"===typeof f&&(f=null);!b.X(f,d)&&f&&(q("Unable to restore state for "+b.type),a.D&&!a.J?(c.clear(),a.b=nc,window&&window.location.reload()):a.H=!0,b.X(null),e=!1)}if(!d&&b.Sa)for(a=b.Sa.split("|"),c=0;c<a.length;c++)b.status(a[c])}return e}
m.Va=function(a){var b=a[0],c=0>a[1];a=a[2];this.g.K=!0;var d=this.A.power;d&&(d.textContent="Shutdown");this.G||(this.O("PC8080 v"+Y+"\nCopyright \u00a9 2012-2016 Jeff Parsons <Jeff@pcjs.org>\nLicense: GPL version 3 or later <http://gnu.org/licenses/gpl.html>"),this.G=!0);this.a&&(tc(this,this.a,b,c,a),sb(this.a));this.H&&(sc(this,b),b.clear());!c&&this.i&&(this.i.clear(),delete this.i);this.f=0};
function sc(a,b){if(ka("There may be a problem with your PC8080 machine.\n\nTo help us diagnose it, click OK to send this PC8080 machine state to http://www.pcjs.org.")){var c=a.N,d=a.c||"",e=b.toString(),f={app:"PC8080"};f.ver=Y;f.url=c;f.user=d;f.type="bug";f.data=e;p("http://www.pcjs.org/api/v1/report",f,!0)}}
function uc(a,b,c){var d,e="none";if(a.f)return null;a.f--;var f=new E(a,Y),h=new E(a,Y,"validate"),g=ia();F(h,"timestamp",g);F(f,"timestamp",g);F(f,"version","1.22.0");F(f,"url",window?window.location.href:null);F(f,"browser",window?window.navigator.userAgent:"");a.a&&a.a.W&&(c&&tb(a.a),d=a.a.W(b,c),"object"===typeof d&&F(f,a.a.id,d),c&&(a.a.g.K=!1,!1===d&&(e=null)));for(var g=w(a.id),k=0;k<g.length;k++){var l=g[k];l.g.K&&(l.W&&(d=l.W(b,c),"object"===typeof d&&F(f,l.id,d)),c&&(l.g.K=!1,!1===d&&(e=
null)))}e&&(c?(g=d=!1,b?(a.c&&vc(a,a.c,f.toString()),hc(h)&&hc(f)||(e=null,d=g=!0)):a.b&&(d=!0,g=3==a.b),d&&f.clear(g)):e=f.toString());c&&(a.g.K=!1,b=a.A.power)&&(b.textContent="Power");a.f=0;return e}m.reset=function(){this.w&&this.w.reset&&this.w.reset();for(var a=w(this.id),b=0;b<a.length;b++){var c=a[b];c!==this&&c!==this.w&&c.reset&&c.reset()}};m.start=function(a,b){for(var c=w(this.id),d=0;d<c.length;d++){var e=c[d];"CPU"!=e.type&&e!==this&&e.start&&e.start(a,b)}};
m.stop=function(a,b){for(var c=w(this.id),d=0;d<c.length;d++){var e=c[d];"CPU"!=e.type&&e!==this&&e.stop&&e.stop(a,b)}};
m.P=function(a,b,c){var d=this;switch(b){case "power":return this.A[b]=c,c.onclick=function(){d.f||(d.g.K?uc(d,!1,!0):qc(d,d.xa))},!0;case "reset":return this.A[b]=c,c.onclick=function(){if(d.g.K&&!d.f)if(d.b&&!d.m){var a=ka("Click OK to save changes to this PC8080 machine.\n\nWARNING: If you CANCEL, all disk changes will be discarded.");uc(d,a,!0);!a&&d.D?window&&window.location.reload():d.xa(nc)}else d.reset(),d.a&&sb(d.a)},!0;case "save":if(da(ja(),"pcjs.org")){c.parentNode.removeChild(c);break}this.A[b]=
c;c.onclick=function(){var a=oc(d,!0);if(a){var b=!!(d.b&&!d.m||d.D),c=uc(d,b);b?vc(d,a,c):d.L("Resume disabled, machine state not saved")}};return!0}return!1};
function oc(a,b){var c=a.c;c||(c=oa("user"),void 0!==c?!c&&b&&(c=null,window&&(c=window.prompt("Saving machine states on the pcjs.org server is currently unsupported.\n\nIf you're running your own server, enter your user ID below.","")),c&&((c=wc(a,c))||a.L("The user ID is invalid."))):b&&a.L("Browser local storage is not available"));return c}
function wc(a,b){a.c=null;var c=p(ja()+"/api/v1/user?req=verify&user="+b),d=c[1];if(!c[0]&&d)try{c=eval("("+d+")"),c.code&&"ok"==c.code&&(pa("user",c.data),a.c=c.data)}catch(e){q(e.message+" ("+d+")")}return a.c}function pc(a){var b=null;a.c&&(b=ja()+"/api/v1/user?req=load&user="+a.c+"&state="+fc(a,Y));return b}
function vc(a,b,c){if(c){var d={req:"store"};d.user=b;d.state=fc(a,Y);d.data=c;b=p(ja()+"/api/v1/user",d);d=b[0];if(b[1]){if(d){var e=d.indexOf("\n");0<e&&(d=d.substr(0,e));d.indexOf("Error: ")||(d=d.substr(7))}d='{"code":'+b[1]+',"data":"'+d+'"}'}b=JSON.parse(d);b&&"ok"==b.code?a.L("Machine state saved to server"):c&&(c=b&&b.data||"unable to save machine state",c="error"==b.code?"Error: "+c:"Error "+b.code+": "+c,a.L(c),pa("user",""),a.c=null)}}
function Sa(a,b,c){a=w(a.id);for(var d=0;d<a.length;d++){var e=a[d];if(c)c==e&&(c=null);else if(e.type==b)return e}return null}m.fa=function(a){this.a&&this.a.fa(a);this.h&&this.h.fa(a)};
function zb(a,b){for(var c=0;c<a.B.length;c++)a:{var d=a.B[c];if(0<=b){if(b&1){d=d.a;d.G=d.G&-8|10;break a}var e=d.a;e.G=e.G&-8|9;if(e=d.l){for(var e=d.w,f=d.i,h=!0,g=d.j>>>e.C;0<f&&g<e.b.length;)e.b[g].R&&(e.b[g].R=h=!1,e.b[g].Xa=!0),f-=e.H,g++;e=h}if(e)break a}for(var e=d.j,f=e+d.i,h=0,g=d.G,k=0,l=0,x=d.b,r=0,Z=d.c,wb=0;e<f;){var A;A=d.w;var ha=e,Fa=ha&A.c,ra=(ha&A.h)>>>A.C;A=Fa!=A.c?A.b[ra].fb(Fa,ha):A.b[ra++].Ma(Fa,ha)|A.b[ra&A.v].Ma(0,ha+1)<<8;if(d.l&&A===d.f[h])k+=d.D;else{d.f[h]=A;A=A>>8|(A&
255)<<8;ha=65536;Fa=16;k<x&&(x=k);for(ra=0;ra<d.D;ra++){var la=(A&(ha>>=1))>>--Fa,Ga=d.o,sa=k++,la=g[la],sa=(sa+l*Ga.width)*la.length;Ga.data[sa]=la[0];Ga.data[sa+1]=la[1];Ga.data[sa+2]=la[2];Ga.data[sa+3]=la[3]}k>r&&(r=k);l<Z&&(Z=l);l>=wb&&(wb=l+1)}e+=2;h++;if(k>=d.b&&(k=0,l++,l>d.c))break}d.l=!0;x<d.b&&(d.H.putImageData(d.o,0,0,x,Z,r-x,wb-Z),d.m.drawImage(d.h,0,0,d.b,d.c,0,0,d.J,d.M))}}
xa(function(){for(var a=z(document,"pc8080-machine"),b=0;b<a.length;b++)for(var c=a[b],d=y(c),c=z(c,"pc8080","computer"),e=0;e<c.length;e++){var f=c[e],h=y(f),h=new lc(h,d,!0);Ma(h,f);h.C&&qc(h,h.xa)}});ta.show.push(function(){for(var a=z(document,"pc8080","computer"),b=0;b<a.length;b++){var c=y(a[b]);(c=La("Computer",c.id))&&c.G&&!c.g.K&&c.xa(-1)}});
ta.exit.push(function(){for(var a=z(document,"pc8080","computer"),b=0;b<a.length;b++){var c=y(a[b]);(c=La("Computer",c.id))&&c.g.K&&uc(c,!(!c.b||c.m),!0)}});var xc=0;function yc(a,b,c,d,e,f){e("Loading "+a+"...");p(a,null,!0,function(h,g,k){k?(g||(g="unable to load "+a+" ("+k+")"),f(g,null)):zc(g,a,b,c,d,e,f)})}
function zc(a,b,c,d,e,f,h){function g(a,f){if(f)h(f,null);else{if(c){Ka(c,b,a);var g=b;g&&0>g.indexOf("/")&&"/"==window.location.pathname.slice(-1)&&(g=window.location.pathname+g);d?"}"==d.slice(-1)?(d=d.slice(0,-1),1<d.length&&(d+=",")):d='{state:"'+d+'",':d="{";d+='url:"'+g+'"}';"object"==typeof resources&&(g=null);a=a.replace(/(<machine[^>]*\sid=)(['"]).*?\2/,"$1$2"+c+"$2"+(d?" parms='"+d+"'":"")+(g?' url="'+g+'"':""))}e||(a=a.replace(/(<xsl:variable name="APPCLASS">).*?(<\/xsl:variable>)/,"$1pc8080$2"));
g=null;if("<"==a.charAt(0))try{e||(a=a.replace(/<!DOCTYPE(.|[\r\n])*]>\s*/g,"")),window.ActiveXObject||"ActiveXObject"in window?(g=new window.ActiveXObject("Microsoft.XMLDOM"),g.async=!1,g.loadXML(a)):g=(new window.DOMParser).parseFromString(a,"text/xml")}catch(r){g=null,a=r.message}else a="unrecognized XML: "+(255<a.length?a.substr(0,255)+"...":a);h(a,g)}}a?e?Ac(a,f,g):g(a,null):h("no data"+(b?" for file: "+b:""),null)}
function Ac(a,b,c){var d;if(d=/<([a-z]+)\s+ref="(.*?)"(.*?)\/>/g.exec(a)){var e=d[2];b("Loading "+e+"...");p(e,null,!0,function(f,h,g){if(g||!h)c(a,"unable to resolve XML reference: "+d[0]+" ("+g+")");else{if(f=d[3])if(g=h.match(new RegExp("<"+d[1]+"[^>]*>"))){for(var k=g[0],l,x=/( [a-z]+=)(['"])(.*?)\2/g;l=x.exec(f);)k=0>k.indexOf(l[1])?k.replace(">",l[0]+">"):k.replace(new RegExp(l[1]+"(['\"])(.*?)\\1"),l[0]);g[0]!=k&&(h=h.replace(g[0],k))}else{c(a,"missing <"+d[1]+"> in "+e);return}h=h.replace(/<\?xml[^>]*>[\r\n]*/,
"");a=a.replace(d[0],h);Ac(a,b,c)}})}else c(a,null)}
function Bc(a,b,c,d){function e(a){if(void 0===g){var b=h&&z(h,"machine-warning");g=b&&b[0]||h}g&&(g.innerHTML=fa(a))}function f(a){e("Error: "+a);k&&(--xc||za(!0));k=!1}var h,g,k=!0;xc++;Ja[a]={};try{if(h=document.getElementById(a)){var l;if("object"==typeof resources&&(l=resources.css)){var x=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css";r.styleSheet?r.styleSheet.cssText=l:r.appendChild(document.createTextNode(l));x.appendChild(r)}c||
(c="/versions/pc8080/1.22.0/components.xsl");l=function(d,g){g?yc(c,null,null,!1,e,function(d,l){if(l)if(Ka(a,c,d),e("Processing "+b+"..."),window.ActiveXObject||"ActiveXObject"in window){var k=g.transformNode(l);k?(h.outerHTML=k,--xc||za(!0)):f("transformNodeToObject failed")}else document.implementation&&document.implementation.createDocument?(k=new XSLTProcessor,k.importStylesheet(l),(k=k.transformToFragment(g,document))?h.parentNode?(h.parentNode.replaceChild(k,h),--xc||za(!0)):f("invalid machine element: "+
a):f("transformToFragment failed")):f("unable to transform XML: unsupported browser");else f(d)}):f(d)};"<"!=b.charAt(0)?yc(b,a,d,!0,e,l):zc(b,null,a,d,!1,e,l)}else f("missing machine element: "+a)}catch(Z){f(Z.message)}return k}window.embedPC8080=function(a,b,c,d){za(!1);return Bc(a,b,c,d)};window.enableEvents=za;window.sendEvent=Aa;
function Cc(a,b,c,d){if(!c&&b){d.push(b);a=Ja[d[0]];b=null;for(var e in a)if(da(e,"components.xsl")){b=e.replace(".xsl",".css");break}b?p(b,null,!0,function(a,b){Dc(b,d)}):Dc(null,d)}else q("Error ("+c+") requesting "+a)}
function Dc(a,b){var c,d,e,f=b[0],h=b[1];c=b[4];c=c.match(/^(\s*\(function\(\)\{)([\s\S]*)(}\)\(\);\s*)$/);var g=Ja[f],k={},l;for(l in g){var x=g[l],r=ca(l);if("xml"==r){for(r=/[ \t]*<disk [^>]*path=(['"])(.*?)\1.*?<\/disk>\n?/g;d=r.exec(g[l]);){var Z=d[2];Z&&(g[Z]||(x=x.replace(d[0],"")))}d=l=ba(l)}else"xsl"==r&&(e=l=ba(l));k[l]=x}a&&(k[l="css"]=a);b[2]&&(k[l="parms"]=b[2]);b[3]&&(k[l="state"]=b[3]);d&&e?(l=JSON.stringify(k),h+=".js",c=c[1]+"var resources="+l+";"+c[2]+c[3],c=c.replace(/\u00A9/g,
"&#xA9;"),l=h,g=null,k="data:application/javascript,",k=qa("Firefox")?k+encodeURIComponent(c):k+encodeURI(c),l&&(g=document.createElement("a"),"string"!=typeof g.download&&(g=null)),g?(g.href=k,g.download=l,document.body.appendChild(g),g.click(),document.body.removeChild(g),c="Check your Downloads folder for "+l+"."):(window.open(k),c="Check your browser for a new window/tab containing the requested data"+(l?" ("+l+")":"")+"."),c+=', copy it to your web server as "'+h+'", and then add the following to your web page:\n\n',
c+='<div id="'+f+'"></div>\n',c+="...\n",c+='<script type="text/javascript" src="'+h+'">\x3c/script>\n',c+='<script type="text/javascript">embedPC("'+f+'","'+d+'","'+e+'");\x3c/script>\n\n',c+="The machine should appear where the <div> is located.",q(c)):q("Missing XML/XSL resources")}
window.savePC=function(a,b,c){var d=La("Computer",a),e=La("Debugger",a);if(d){var f=uc(d,!0),h=d.l?JSON.stringify(d.l):null;b||(b="/versions/pcjs/1.22.0/pc"+(e?"-dbg":"")+".js");if(c&&c({state:f,eb:h}))return!0;p(b,null,!0,function(c,d,e){Cc(c,d,e,[a,ba(b,!0),h,f])});return!0}q("Unable to identify machine '"+a+"'");return!1};})();
